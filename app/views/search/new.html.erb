<% unless user_signed_in? %>
<div class='lead text-center'>
	McClures is about bringing you closer to the politicians that represent you.
</div>
<% end %>

<div class='lead text-center'>
	<%= flash[:error] %>
	<%= form_tag("/search/new", method: "get") do %>
	<%= label_tag(:zip_code, "Enter your 5-digit zip code") %>
	<%= text_field_tag(:zip_code) %>
	<%= submit_tag("Find my Politicians") %>
	<% end %>
</div>

<% if @search_results.empty? %>
	<%# @message_no_search_results %> 
<% else %>
<div class="list-group">
<% @search_results.each do |this_result| %>
	<div class="list-group-item">
		<%= "#{this_result.title} #{this_result.first_name} #{this_result.middle_name} #{this_result.last_name} #{this_result.name_suffix}" %>
		<%= this_result.in_office ? "representing" : "represented" %>
		<%= "district #{this_result.district} in #{this_result.state_name} in the #{this_result.chamber}" %>
<br />
		<%= this_result.in_office ? "Serving" : "Served" %>
		<%= "from #{this_result.term_start} to #{this_result.term_end}" %>
<br />
		<% case this_result.party %>
		<% when "R" %>
		<%= "Republican" %>
		<% when "D" %>
		<%= "Democrat" %>
		<% when "I" %>
		<%= "Independent" %>
		<% else %>
		<%= "No party affiliation" %>
		<% end %>	
<br />
	<%= link_to "View Profile", politician_show_path(bioguide_id: this_result.bioguide_id), class: 'btn btn-info'  %>
	<%= link_to "Add to Stash", favorites_create_path(bioguide_id: this_result.bioguide_id), class: 'btn btn-primary' %>
</div><!--END LIST GROUP ITEM-->
<% end %>
</div><!--END LIST GROUP-->
<% end %>

<div class='row'>
	<div class='col-md-12'>
<% if user_signed_in? %>
	<h3>My Recent Searches</h3>
	<% this_users_recent_search_text = [] %>
    <% @this_users_recent_searches.each do |search| %>
      <% search.parameters.each do |key, value| %> 
        <% unless ["commit", "action", "controller", "utf8"].include? key %>
        	<% this_users_recent_search_text.push("#{key.humanize.titleize}, #{value}") %>
        <% end %>
      <% end %>
    <% end %>
	<% @this_users_recent_searches.each_with_index do |a_previous_search, i| %>
		<%= link_to "#{this_users_recent_search_text[i]}", new_search_path(a_previous_search.parameters)  %><br />
	<% end %>
<% end %>	
<h3>Everyone's Recent Searches</h3>
	<% recent_search_text = [] %>
    <% @recent_searches.each do |search| %>
      <% search.parameters.each do |key, value| %> 
        <% unless ["commit", "action", "controller", "utf8"].include? key %>
        	<% recent_search_text.push("#{key.humanize.titleize}, #{value}") %>
        <% end %>
      <% end %>
    <% end %>
	<% @recent_searches.each_with_index do |a_previous_search, i| %>
		<%= link_to "#{recent_search_text[i]}", new_search_path(a_previous_search.parameters)  %><br />
	<% end %>
	</div>
</div>